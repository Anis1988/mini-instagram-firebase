{"ast":null,"code":"import _slicedToArray from\"/Users/anismedini/Desktop/code-js/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Button}from\"@material-ui/core\";import{storage,db}from\"./firebase\";import firebase from\"firebase\";import\"./imageUpload.css\";export default function ImageUpload(_ref){var username=_ref.username;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),caption=_useState6[0],setCaption=_useState6[1];var handleChange=function handleChange(e){if(e.target.files[0]){setImage(e.target.files[0]);}};// Handle the Upload Button\nvar handleUpload=function handleUpload(){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){// we are visualizing the progress\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},// get the error\nfunction(error){console.log(error);alert(error.message);},function(){// store it in the database\nstorage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){db.collection(\"posts\").add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageUrl:url,username:username});setProgress(0);setCaption(\"\");setImage(null);});});};return/*#__PURE__*/React.createElement(\"div\",{className:\"imageUpload\"},/*#__PURE__*/React.createElement(\"progress\",{className:\"imageUpload__progress\",value:progress,max:\"100\"}),/*#__PURE__*/React.createElement(\"input\",{className:\"input-caption\",type:\"text\",placeholder:\"Enter a caption\",value:caption,onChange:function onChange(event){return setCaption(event.target.value);}}),/*#__PURE__*/React.createElement(\"input\",{className:\"upload-btn\",type:\"file\",onChange:handleChange}),/*#__PURE__*/React.createElement(Button,{onClick:handleUpload},\"Upload\"));}","map":{"version":3,"sources":["/Users/anismedini/Desktop/code-js/instagram-clone/src/ImageUpload.js"],"names":["React","useState","Button","storage","db","firebase","ImageUpload","username","image","setImage","progress","setProgress","caption","setCaption","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"mappings":"wKAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,MAAT,KAAuB,mBAAvB,CACA,OAASC,OAAT,CAAkBC,EAAlB,KAA4B,YAA5B,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,MAAO,mBAAP,CAEA,cAAe,SAASC,CAAAA,WAAT,MAAmC,IAAZC,CAAAA,QAAY,MAAZA,QAAY,eACtBN,QAAQ,CAAC,IAAD,CADc,wCACzCO,KADyC,eAClCC,QADkC,8BAEhBR,QAAQ,CAAC,CAAD,CAFQ,yCAEzCS,QAFyC,eAE/BC,WAF+B,8BAGlBV,QAAQ,CAAC,EAAD,CAHU,yCAGzCW,OAHyC,eAGhCC,UAHgC,eAKhD,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CAC1B,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,CAAuB,CACrBR,QAAQ,CAACM,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACD,CACF,CAJD,CAMA;AACA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB,GAAMC,CAAAA,UAAU,CAAGhB,OAAO,CAACiB,GAAR,kBAAsBZ,KAAK,CAACa,IAA5B,GAAoCC,GAApC,CAAwCd,KAAxC,CAAnB,CACAW,UAAU,CAACI,EAAX,CACE,eADF,CAEE,SAACC,QAAD,CAAc,CACZ;AACA,GAAMd,CAAAA,QAAQ,CAAGe,IAAI,CAACC,KAAL,CACdF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GADrC,CAAjB,CAGAjB,WAAW,CAACD,QAAD,CAAX,CACD,CARH,CASE;AACA,SAACmB,KAAD,CAAW,CACTC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACAG,KAAK,CAACH,KAAK,CAACI,OAAP,CAAL,CACD,CAbH,CAcE,UAAM,CACJ;AACA9B,OAAO,CACJiB,GADH,CACO,QADP,EAEGc,KAFH,CAES1B,KAAK,CAACa,IAFf,EAGGc,cAHH,GAIGC,IAJH,CAIQ,SAACC,GAAD,CAAS,CACbjC,EAAE,CAACkC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACzBC,SAAS,CAAEnC,QAAQ,CAACoC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADc,CAEzB/B,OAAO,CAAEA,OAFgB,CAGzBgC,QAAQ,CAAEP,GAHe,CAIzB9B,QAAQ,CAAEA,QAJe,CAA3B,EAMAI,WAAW,CAAC,CAAD,CAAX,CACAE,UAAU,CAAC,EAAD,CAAV,CACAJ,QAAQ,CAAC,IAAD,CAAR,CACD,CAdH,EAeD,CA/BH,EAiCD,CAnCD,CAoCA,mBACE,2BAAK,SAAS,CAAC,aAAf,eACE,gCAAU,SAAS,CAAC,uBAApB,CAA4C,KAAK,CAAEC,QAAnD,CAA6D,GAAG,CAAC,KAAjE,EADF,cAEE,6BACE,SAAS,CAAC,eADZ,CAEE,IAAI,CAAC,MAFP,CAGE,WAAW,CAAC,iBAHd,CAIE,KAAK,CAAEE,OAJT,CAKE,QAAQ,CAAE,kBAACiC,KAAD,QAAWhC,CAAAA,UAAU,CAACgC,KAAK,CAAC7B,MAAN,CAAa8B,KAAd,CAArB,EALZ,EAFF,cASE,6BAAO,SAAS,CAAC,YAAjB,CAA8B,IAAI,CAAC,MAAnC,CAA0C,QAAQ,CAAEhC,YAApD,EATF,cAUE,oBAAC,MAAD,EAAQ,OAAO,CAAEI,YAAjB,WAVF,CADF,CAcD","sourcesContent":["import React, { useState } from \"react\";\nimport { Button } from \"@material-ui/core\";\nimport { storage, db } from \"./firebase\";\nimport firebase from \"firebase\";\nimport \"./imageUpload.css\";\n\nexport default function ImageUpload({ username }) {\n  const [image, setImage] = useState(null);\n  const [progress, setProgress] = useState(0);\n  const [caption, setCaption] = useState(\"\");\n\n  const handleChange = (e) => {\n    if (e.target.files[0]) {\n      setImage(e.target.files[0]);\n    }\n  };\n\n  // Handle the Upload Button\n  const handleUpload = () => {\n    const uploadTask = storage.ref(`images/${image.name}`).put(image);\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        // we are visualizing the progress\n        const progress = Math.round(\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        );\n        setProgress(progress);\n      },\n      // get the error\n      (error) => {\n        console.log(error);\n        alert(error.message);\n      },\n      () => {\n        // store it in the database\n        storage\n          .ref(\"images\")\n          .child(image.name)\n          .getDownloadURL()\n          .then((url) => {\n            db.collection(\"posts\").add({\n              timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n              caption: caption,\n              imageUrl: url,\n              username: username,\n            });\n            setProgress(0);\n            setCaption(\"\");\n            setImage(null);\n          });\n      }\n    );\n  };\n  return (\n    <div className=\"imageUpload\">\n      <progress className=\"imageUpload__progress\" value={progress} max=\"100\" />\n      <input\n        className=\"input-caption\"\n        type=\"text\"\n        placeholder=\"Enter a caption\"\n        value={caption}\n        onChange={(event) => setCaption(event.target.value)}\n      />\n      <input className=\"upload-btn\" type=\"file\" onChange={handleChange} />\n      <Button onClick={handleUpload}>Upload</Button>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}